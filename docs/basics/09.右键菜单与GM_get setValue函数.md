---
sidebar_position: 9
---

# å³é”®èœå•ä¸GM_get/setValueå‡½æ•°

ä»‹ç»GM_get/setValueä¸¤ä¸ªå‡½æ•°,æ²¹çŒ´è„šæœ¬çš„å³é”®èœå•èƒ½åŠ›.æœ€åæ¥ä¸€ä¸ªèœå•ç‚¹å‡»è®¡æ¬¡çš„è„šæœ¬æ¼”ç¤º.

# GM_get/setValue

å®˜æ–¹æ–‡æ¡£åœ°å€:https://www.tampermonkey.net/documentation.php#api:GM_setValue

è¿™ä¸¤ä¸ªå‡½æ•°å¯ä»¥ä½¿ç”¨KVé”®å€¼å¯¹çš„æ–¹å¼å­˜å‚¨æ•°æ®,å°†æ•°æ®ä¿å­˜åœ¨æµè§ˆå™¨çš„å‚¨å­˜ä¸­(tampermonkeyæ’ä»¶æ˜¯websqlä¸­),å…·ä½“å®¹é‡ç”±æ‰©å±•å®ç°ä½¿ç”¨çš„å­˜å‚¨ä»‹è´¨æ‰€å†³å®š,ä¸è¿‡ä¸€èˆ¬æ¥è¯´è‚¯å®šæ˜¯å¤Ÿç”¨çš„,ä¸ç”¨å¤ªå…³æ³¨.

å¦å¤–è¿™ä¸ªå‡½æ•°åœ¨Greasemonkeyä¸­æ˜¯å¼‚æ­¥çš„,Tampermonkeyæ˜¯åŒæ­¥çš„,æˆ‘ä»¬è¿™é‡Œåªé’ˆå¯¹Tampermonkeyæ¥è®²è§£.æ³¨æ„:åœ¨ä¸¤ä¸ªä¸åŒçš„è„šæœ¬ä¸­æ˜¯æ— æ³•å…±äº«æ•°æ®çš„.

è¿™ä¸ªå‡½æ•°å¯ä»¥ç”¨æ¥ä¿å­˜ä¸€äº›é…ç½®æ•°æ®,åƒæŸäº›è„šæœ¬çš„é…ç½®æ˜¯å†™åœ¨è„šæœ¬ä»£ç ä¸­çš„,æ›´æ–°è„šæœ¬åé…ç½®åˆè¢«è¿˜åŸ,å¾ˆä¸æ–¹ä¾¿,è¿™æ—¶å°±å¯ä»¥æ”¹é€ æˆget/setValueå‡½æ•°æ¥å‚¨å­˜ä¸‹æ¥.

### ä½¿ç”¨æ–¹æ³•

æ–¹æ³•éå¸¸ç®€å•,æˆ‘ä»¬ä¸€ç¬”å¸¦è¿‡.æ³¨æ„ä¸¤ä¸ªå‡½æ•°éƒ½è¦ä½¿ç”¨ `grant` å»ç”³è¯·

```js
// ==UserScript==
// @name         New Userscript2
// @namespace    http://tampermonkey.net/
// @version      0.1
// @description  try to take over the world!
// @author       You
// @match        https://bbs.tampermonkey.net.cn/
// @grant        GM_setValue
// @grant        GM_getValue
// ==/UserScript==

GM_setValue("qqq",123);
console.log(GM_getValue("qqq"));
```
# å³é”®èœå•

ä¹‹å‰åœ¨è¯´[run-at](https://www.tampermonkey.net/documentation.php#meta:run_at)çš„æ—¶å€™,æœ‰ä¸€ä¸ªå±æ€§,ä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰æ³¨æ„,å½“æ—¶ä¹Ÿæ²¡æœ‰è¯¦ç»†è®²è§£.é™¤äº† `document-start/body/end/idle`è¿™äº›æ§åˆ¶è„šæœ¬è¿è¡Œæ—¶é—´çš„å¤–,è¿˜æœ‰ä¸€ä¸ª `context-menu`çš„å±æ€§,ç”¨äºå³é”®ç‚¹å‡»èœå•çš„æ—¶å€™æ‰§è¡Œè„šæœ¬.å¦‚æœä½ ä½¿ç”¨äº† `context-menu`å±æ€§,é‚£ä¹ˆå½“ä½ åœ¨æ‰€åŒ¹é…çš„é¡µé¢ä¸Šå³é”®æ—¶,èœå•ä¸­å°±ä¼šä»¥ä½ è„šæœ¬åæ˜¾ç¤ºå‡ºä¸€èœå•é¡¹,ç‚¹å‡»ä¹‹åå°±æ˜¯æ‰§è¡Œä½ çš„è„šæœ¬ä»£ç .

(æ–‡æ¡£çš„æœ€åè¿˜æäº†ä¸€ä¸‹ `#include`å’Œ `#exclude`,è¿™ä¸¤ä¸ªå±æ€§å’Œ `#match`åŠŸèƒ½å·®ä¸å¤š,ğŸ¤¡å®é™…ä¸Šæˆ‘ä¹Ÿæ²¡ç”¨è¿‡è¿™ä¸¤,å¿½ç•¥å¥½äº†)

```js
// ==UserScript==
// @name         å³é”®èœå•å’Œvalude demo
// @namespace    http://tampermonkey.net/
// @version      0.1
// @description  try to take over the world!
// @author       You
// @match        https://bbs.tampermonkey.net.cn/*
// @run-at       context-menu
// ==/UserScript==

alert("èœå•è¢«ç‚¹å‡»äº†");
```

### è‡ªå®šä¹‰çš„èœå•

é™¤äº†ä½¿ç”¨ `@run-at context-menu`ç”Ÿæˆèœå•å¤–,æ²¹çŒ´è¿˜æä¾›äº†ä¸¤ä¸ªå‡½æ•°[GM_registerMenuCommand](https://www.tampermonkey.net/documentation.php#api:GM_registerMenuCommand)å’Œ[GM_unregisterMenuCommand](https://www.tampermonkey.net/documentation.php#api:GM_unregisterMenuCommand),åˆ†åˆ«ç”¨äºæ³¨å†Œèœå•å’Œåˆ é™¤èœå•.æ›´åŠ çµæ´»,ä½†æ˜¯ä¸èƒ½æ˜¾ç¤ºåœ¨é¡µé¢ä¸Š,éœ€è¦åˆ°æ²¹çŒ´å›¾æ ‡è„šæœ¬é‚£é‡Œå»è¿›è¡Œç‚¹å‡».

```js
// ==UserScript==
// @name         å³é”®èœå•å’Œvalude demo
// @namespace    http://tampermonkey.net/
// @version      0.1
// @description  try to take over the world!
// @author       You
// @match        https://bbs.tampermonkey.net.cn/*
// @grant    GM_registerMenuCommand
// @grant    GM_unregisterMenuCommand
// ==/UserScript==

let id=GM_registerMenuCommand ("è‡ªå®šä¹‰çš„èœå•", function(){
   alert('èœå•ç‚¹å‡»');
   GM_unregisterMenuCommand(id);//åˆ é™¤èœå•
}, "h");
// ç¬¬ä¸‰ä¸ªå‚æ•° accessKey ä¸ºå¿«æ·é”®ï¼Œè¾“å…¥hå³å¯è§¦å‘ã€‚æœ¬è„šæœ¬åœ¨ç‚¹å‡»ä¸€æ¬¡ä¹‹åä¼šå°†èœå•åˆ é™¤ã€‚
```

# èœå•ç‚¹å‡»è®¡æ•°å™¨

åˆ©ç”¨æ²¹çŒ´çš„å­˜å‚¨åŠŸèƒ½æ¥ä¿å­˜èœå•è¢«ç‚¹å‡»çš„æ¬¡æ•°,ç„¶ååˆ·æ–°æ¬¡æ•°(çº¯å±ä½¿ç”¨è€Œä½¿ç”¨...æƒ³ä¸åˆ°ä»€ä¹ˆå®æˆ˜çš„ä¾‹å­...)

```js
// ==UserScript==
// @name         å³é”®èœå•å’Œvalude demo
// @namespace    http://tampermonkey.net/
// @version      0.1
// @description  try to take over the world!
// @author       You
// @match        https://bbs.tampermonkey.net.cn/*
// @grant    GM_setValue
// @grant    GM_getValue
// @grant    GM_registerMenuCommand
// @grant    GM_unregisterMenuCommand
// ==/UserScript==

let id=GM_registerMenuCommand ("èœå•ç¬¬"+GM_getValue("click_num",0)+"ç‚¹å‡»",click, "h");

function click(){
   GM_unregisterMenuCommand(id);
   GM_setValue("click_num",GM_getValue("click_num",0)+1)
   id=GM_registerMenuCommand ("èœå•ç¬¬"+GM_getValue("click_num",0)+"ç‚¹å‡»",click, "h");
}
```






